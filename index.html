<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- ===== HEAD SEO DE BASE ===== -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- TITRE : ~50‚Äì60 caract√®res, mot-cl√© principal au d√©but -->
    <title>Convertissez vos Relev√©s PDF en Excel | Gratuit, Rapide & En ligne</title>

    <!-- META DESCRIPTION : ~150‚Äì160 caract√®res -->
    <meta name="description" content="Convertissez vos relev√©s de compte PDF en Excel gratuitement en ligne. Transformez vos relev√©s bancaires PDF en fichiers Excel XLS/CSV structur√©s. Toutes banques fran√ßaises." />

    <!-- CANONICAL : √©vite le contenu dupliqu√© -->
    <link rel="canonical" href="https://convertir-releve-compte-pdf-excel.com/" />

    <!-- FAVICONS & PWA -->
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" type="image/svg+xml" href="/icon.svg" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#6366f1" />

    <!-- OPEN GRAPH (Facebook, LinkedIn) -->
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="fr_FR" />
    <meta property="og:site_name" content="Convertisseur Relev√© PDF Excel" />
    <meta property="og:title" content="Convertissez vos Relev√©s PDF en Excel - Gratuit" />
    <meta property="og:description" content="Convertissez vos relev√©s de compte PDF en Excel gratuitement en ligne. Service fran√ßais, toutes banques, fichiers XLS/CSV propres, s√©curis√© RGPD." />
    <meta property="og:url" content="https://convertir-releve-compte-pdf-excel.com/" />
    <meta property="og:image" content="https://convertir-releve-compte-pdf-excel.com/@bank%20statement%20converter.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Convertir vos relev√©s de compte bancaire PDF en Excel en ligne - Service fran√ßais gratuit" />

    <!-- TWITTER CARD -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Convertissez vos Relev√©s PDF en Excel - Gratuit" />
    <meta name="twitter:description" content="Convertissez vos relev√©s de compte PDF en Excel facilement en ligne. Service fran√ßais gratuit, toutes banques, fichiers XLS/CSV." />
    <meta name="twitter:image" content="https://convertir-releve-compte-pdf-excel.com/@bank%20statement%20converter.jpg" />
    <meta name="twitter:image:alt" content="Convertir vos relev√©s de compte bancaire PDF en Excel en ligne - Service fran√ßais gratuit" />

    <!-- PR√âCONNEXION (utile si API externe) -->
    <link rel="preconnect" href="https://api.v1.buyingsignal.io" crossorigin />
    

    <!-- ===== DONN√âES STRUCTUR√âES JSON-LD ===== -->
    <!-- WebApplication / SoftwareApplication -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": ["WebApplication","SoftwareApplication"],
      "name": "Convertisseur Relev√© PDF Excel",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Web",
      "url": "https://convertir-releve-compte-pdf-excel.com/",
      "description": "Convertissez vos relev√©s de compte PDF en Excel gratuitement en ligne. Service fran√ßais pour transformer vos relev√©s bancaires PDF en fichiers Excel XLS/CSV structur√©s.",
      "image": "https://convertir-releve-compte-pdf-excel.com/@bank%20statement%20converter.jpg",
      "offers": {
        "@type": "Offer",
        "price": "0.00",
        "priceCurrency": "EUR"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Convertisseur Relev√© PDF Excel",
        "url": "https://convertir-releve-compte-pdf-excel.com/"
      }
    }
    </script>

    <!-- Organization -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Convertisseur Relev√© PDF Excel",
      "url": "https://convertir-releve-compte-pdf-excel.com/",
      "logo": "https://convertir-releve-compte-pdf-excel.com/@bank%20statement%20converter.jpg",
      "sameAs": [
        "https://www.linkedin.com/company/buyingsignal"
      ]
    }
    </script>

    <!-- FAQPage -->
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"FAQPage",
      "mainEntity":[
        {
          "@type":"Question",
          "name":"Mes relev√©s sont-ils en s√©curit√© ?",
          "acceptedAnswer":{"@type":"Answer","text":"Oui. Les fichiers sont trait√©s de mani√®re s√©curis√©e, uniquement pour la conversion, puis supprim√©s. Nous respectons le RGPD."}
        },
        {
          "@type":"Question",
          "name":"Quels formats recevais-je en sortie ?",
          "acceptedAnswer":{"@type":"Answer","text":"Excel (XLS/XLSX) et CSV. Les tableaux sont nettoy√©s et pr√™ts pour l'analyse."}
        },
        {
          "@type":"Question",
          "name":"Quelles banques sont support√©es ?",
          "acceptedAnswer":{"@type":"Answer","text":"Notre extracteur fonctionne sur des milliers de banques dans le monde. Si votre PDF est lisible, il sera converti."}
        }
      ]
    }
    </script>

    <!-- HowTo -->
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"HowTo",
      "name":"Comment convertir vos relev√©s de compte PDF en Excel",
      "description":"Guide √©tape par √©tape pour convertir vos relev√©s de compte PDF en Excel facilement et gratuitement en ligne.",
      "image":"https://convertir-releve-compte-pdf-excel.com/@bank%20statement%20converter.jpg",
      "step":[
        {"@type":"HowToStep","name":"T√©l√©verser le PDF","text":"Glissez-d√©posez votre relev√© bancaire PDF ou cliquez pour s√©lectionner le fichier."},
        {"@type":"HowToStep","name":"Lancer la conversion","text":"Cliquez sur Convertir. L'extraction des tableaux se lance automatiquement."},
        {"@type":"HowToStep","name":"T√©l√©charger le fichier Excel","text":"R√©cup√©rez le XLS/XLSX ou CSV pr√™t pour l'analyse."}
      ]
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .container.full-width {
            max-width: none;
            padding: 0;
        }

        /* Header */
        .header {
            padding: 20px 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: #6366f1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            color: white;
            font-weight: bold;
        }

        .nav {
            display: flex;
            gap: 30px;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .nav-link:hover {
            opacity: 1;
        }

        .nav-button {
            background: #6366f1;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .nav-button:hover {
            background: #5855eb;
        }

        /* Auth section styling */
        #auth-section {
            display: flex;
            align-items: center;
        }

        .auth-state {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .auth-btn {
            background: none;
            border: none;
            font-family: inherit;
            font-size: inherit;
            cursor: pointer;
        }

        #auth-loading {
            opacity: 0.7;
        }

        #userGreeting {
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            text-align: center;
            padding: 80px 0;
            color: white;
        }

        .title {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .title .highlight {
            color: #a5b4fc;
        }

        .subtitle {
            font-size: 20px;
            opacity: 0.9;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 60px;
        }

        .btn-primary {
            background: #6366f1;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary:hover {
            background: #5855eb;
        }

        .btn-secondary {
            color: white;
            padding: 15px 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            background: transparent;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Drop Zone */
        .drop-zone-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .drop-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 60px 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        .drop-zone.dragover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }

        .drop-zone-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .upload-icon {
            width: 48px;
            height: 48px;
            opacity: 0.7;
        }

        .drop-zone-text {
            font-size: 18px;
            font-weight: 500;
        }

        .drop-zone-info {
            font-size: 14px;
            opacity: 0.7;
        }

        .file-input {
            display: none;
        }

        /* File List */
        .file-list {
            margin-top: 20px;
        }

        .file-item {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-name {
            font-weight: 500;
        }

        .file-size {
            opacity: 0.7;
            font-size: 14px;
        }

        .remove-file {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-file:hover {
            background: #dc2626;
        }

        /* Submit Button */
        .submit-container {
            margin-top: 30px;
        }

        .btn-submit {
            background: #10b981;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            opacity: 0.5;
            pointer-events: none;
        }

        .btn-submit.enabled {
            opacity: 1;
            pointer-events: auto;
        }

        .btn-submit.enabled:hover {
            background: #059669;
        }

        .btn-submit.loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Success/Error Messages */
        .message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 500;
        }

        .message.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid #10b981;
            color: #10b981;
        }

        .message.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #ef4444;
        }

        .hidden {
            display: none;
        }

        /* Results Section */
        .results-section {
            margin-top: 40px;
            text-align: left;
        }

        .results-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            color: white;
            text-align: center;
        }

        .results-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: white;
        }

        .results-info h4 {
            margin-bottom: 10px;
            color: #a5b4fc;
        }

        .results-info p {
            margin: 5px 0;
            font-size: 14px;
        }

        .tables-container {
            margin-bottom: 30px;
            padding: 0;
            width: 100%;
        }

        .file-section-header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 0;
            padding: 20px;
            margin: 30px 0 15px 0;
            color: white;
            border-left: 4px solid #6366f1;
            width: 100%;
        }

        .file-section-header h3 {
            margin: 0 0 10px 0;
            font-size: 20px;
            font-weight: 600;
            color: #a5b4fc;
        }

        .file-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 14px;
        }

        .file-stats span {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 4px;
        }

        .table-wrapper {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0;
            margin: 0;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            margin-bottom: 20px;
        }



        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            color: #333;
            table-layout: auto;
        }

        .data-table th {
            background: #f8fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e2e8f0;
            color: #475569;
        }

        .data-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table tr:hover {
            background-color: #f8fafc;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        /* Table Download Button */
        .table-download-btn {
            background: #10b981;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }

        .table-download-btn:hover {
            background: #059669;
        }

        .table-header {
            background: #6366f1;
            color: white;
            padding: 15px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header-text {
            flex: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .nav {
                gap: 20px;
            }

            .title {
                font-size: 36px;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .drop-zone {
                padding: 40px 20px;
            }

            .table-wrapper {
                overflow-x: auto;
                margin: 0;
                width: 100%;
                margin-bottom: 20px;
            }

            .data-table {
                min-width: 600px;
            }

            .file-section-header {
                padding: 15px;
                margin: 20px 0 10px 0;
                border-radius: 0;
            }

            .tables-container {
                padding: 0;
            }

            .file-section-header h3 {
                font-size: 18px;
            }

            .file-stats {
                gap: 10px;
                font-size: 13px;
            }
        }

        /* ===== SECTIONS SEO ===== */
        .seo-section {
            padding: 80px 0;
            background: rgba(255, 255, 255, 0.05);
            margin-top: 40px;
        }

        .seo-section:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }

        .seo-title {
            font-size: 36px;
            font-weight: 700;
            color: white;
            text-align: center;
            margin-bottom: 50px;
        }

        /* Steps Grid */
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .step {
            text-align: center;
            color: white;
        }

        .step-number {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #6366f1;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin: 0 auto 20px auto;
        }

        .step h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #a5b4fc;
        }

        .step p {
            opacity: 0.9;
            line-height: 1.6;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            color: white;
            transition: transform 0.3s;
        }

        .feature:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .feature h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #a5b4fc;
        }

        .feature p {
            opacity: 0.9;
            line-height: 1.6;
        }

        /* FAQ Grid */
        .faq-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 30px;
            color: white;
        }

        .faq-item h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #a5b4fc;
        }

        .faq-item p {
            opacity: 0.9;
            line-height: 1.6;
        }

        /* CTA Section */
        .cta-section {
            text-align: center;
            background: rgba(99, 102, 241, 0.1);
        }

        .cta-subtitle {
            font-size: 18px;
            color: white;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .btn-primary.large {
            padding: 20px 40px;
            font-size: 18px;
            font-weight: 600;
        }

        /* Accessibility improvements */
        .btn-primary, .table-download-btn {
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:focus, .table-download-btn:focus {
            outline: 2px solid #a5b4fc;
            outline-offset: 2px;
        }

        /* Responsive SEO sections */
        @media (max-width: 768px) {
            .seo-section {
                padding: 60px 0;
            }

            .seo-title {
                font-size: 28px;
                margin-bottom: 40px;
            }

            .steps-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .features-grid, .faq-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .feature, .faq-item {
                padding: 20px;
            }

            .step-number {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }

        /* Auth Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            pointer-events: all;
        }

        .auth-modal {
            background: white;
            border-radius: 12px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .auth-modal {
            transform: translateY(0);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .modal-subtitle {
            color: #666;
            font-size: 14px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: #f3f4f6;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-input.error {
            border-color: #ef4444;
        }

        .form-error {
            color: #ef4444;
            font-size: 12px;
            margin-top: 4px;
        }

        .otp-input {
            text-align: center;
            font-size: 18px;
            letter-spacing: 0.1em;
            font-family: 'Courier New', monospace;
        }

        .modal-button {
            width: 100%;
            background: #6366f1;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 15px;
        }

        .modal-button:hover:not(:disabled) {
            background: #5855eb;
        }

        .modal-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .modal-button.secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .modal-button.secondary:hover:not(:disabled) {
            background: #e5e7eb;
        }

        .auth-step {
            display: none;
        }

        .auth-step.active {
            display: block;
        }

        .resend-info {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-top: 15px;
        }

        .resend-button {
            background: none;
            border: none;
            color: #6366f1;
            cursor: pointer;
            text-decoration: underline;
            font-size: 12px;
        }

        .resend-button:disabled {
            color: #999;
            cursor: not-allowed;
            text-decoration: none;
        }

        /* Loading state */
        .modal-button.loading {
            position: relative;
            color: transparent;
        }

        .modal-button.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            margin: -8px 0 0 -8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">BC</div>
                    Convertisseur de Relev√©s
                </div>
                <nav class="nav" id="navigation">
                    <a href="#" class="nav-link">Tarifs</a>
                    <a href="#" class="nav-link">Contact</a>
                    <!-- Dynamic auth section -->
                    <div id="auth-section">
                        <!-- Loading state -->
                        <div id="auth-loading" class="auth-state">
                            <span class="nav-link">Chargement...</span>
                        </div>
                        <!-- Not authenticated state -->
                        <div id="auth-buttons" class="auth-state hidden">
                            <button class="nav-link auth-btn" onclick="handleLogin()">Connexion</button>
                            <button class="nav-button auth-btn" onclick="handleRegister()">S'inscrire</button>
                        </div>
                        <!-- Authenticated state -->
                        <div id="user-menu" class="auth-state hidden">
                            <span class="nav-link" id="userGreeting">Bonjour !</span>
                            <button class="nav-link auth-btn" onclick="handleLogout()">D√©connexion</button>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
                    <h1 class="title">
            Convertisseur de Relev√©s de Compte Bancaire PDF en Excel
        </h1>
        <p class="subtitle">
            <strong>Convertissez vos relev√©s de compte bancaire PDF en Excel</strong> gratuitement et facilement.<br>
            Service fran√ßais pour toutes banques : XLS, CSV structur√©s, <strong>s√©curis√© RGPD</strong>.
        </p>
            
            <div class="action-buttons">
                <button class="btn-primary" onclick="document.getElementById('fileInput').click()" aria-label="S√©lectionner un fichier PDF de relev√© bancaire">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                    </svg>
                                            Convertir vos Relev√©s PDF en Excel
                </button>
                <a href="#faq" class="btn-secondary">Comment convertir ?</a>
            </div>

            <div class="drop-zone-container">
                <div class="drop-zone" id="dropZone">
                    <div class="drop-zone-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            <path d="M12,11L16,15H13V19H11V15H8L12,11Z"/>
                        </svg>
                        <div class="drop-zone-text">Glissez vos fichiers PDF ici ou cliquez pour s√©lectionner</div>
                        <div class="drop-zone-info">Formats support√©s: PDF ‚Ä¢ Taille max: 10MB par fichier</div>
                    </div>
                </div>

                <input type="file" id="fileInput" class="file-input" multiple accept=".pdf" aria-label="S√©lectionner des fichiers PDF" />

                <div class="file-list" id="fileList"></div>

                <div class="submit-container">
                    <button class="btn-submit" id="submitBtn" onclick="submitFiles()" aria-label="Convertir les fichiers PDF s√©lectionn√©s en Excel">
                        Convertir en Excel maintenant
                    </button>
                </div>

                <div class="message hidden" id="message"></div>

                <!-- Results Section -->
                <div class="results-section hidden" id="resultsSection">
                    <div class="container">
                        <h3 class="results-title">R√©sultats de la conversion</h3>
                        <div class="results-info" id="resultsInfo"></div>
                    </div>
                    <div class="container full-width">
                        <div class="tables-container" id="tablesContainer"></div>
                    </div>
                </div>
            </div>

            <!-- ===== SECTIONS SEO ===== -->
            <!-- Comment √ßa marche -->
            <section class="seo-section">
                <div class="container">
                    <h2 class="seo-title">Comment convertir vos relev√©s de compte bancaire PDF en Excel ?</h2>
                    <div class="steps-grid">
                        <div class="step">
                            <div class="step-number">1</div>
                            <h3>T√©l√©verser votre relev√© PDF</h3>
                            <p>Glissez-d√©posez votre relev√© de compte PDF ou cliquez pour s√©lectionner le fichier bancaire depuis votre ordinateur.</p>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <h3>Convertir automatiquement</h3>
                            <p>Cliquez sur "Convertir". Notre service fran√ßais convertit vos relev√©s de compte PDF en Excel automatiquement avec pr√©cision.</p>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <h3>T√©l√©charger votre Excel</h3>
                            <p>R√©cup√©rez votre relev√© converti en Excel XLS/CSV structur√©, pr√™t pour votre comptabilit√©.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Pourquoi nous ? -->
            <section class="seo-section features-section">
                <div class="container">
                    <h2 class="seo-title">Pourquoi convertir vos relev√©s de compte PDF en Excel avec nous ?</h2>
                    <div class="features-grid">
                        <div class="feature">
                            <div class="feature-icon">üéØ</div>
                            <h3>Conversion pr√©cise</h3>
                            <p>Convertissez vos relev√©s de compte PDF en Excel avec pr√©cision. Notre IA fran√ßaise reconna√Æt montants, dates et op√©rations.</p>
                        </div>
                        <div class="feature">
                            <div class="feature-icon">üá´üá∑</div>
                            <h3>Service fran√ßais RGPD</h3>
                            <p>Convertissez vos relev√©s PDF en toute s√©curit√©. Donn√©es trait√©es en France, supprim√©es apr√®s conversion, conforme RGPD.</p>
                        </div>
                        <div class="feature">
                            <div class="feature-icon">üè¶</div>
                            <h3>Toutes banques fran√ßaises</h3>
                            <p>Compatible toutes banques : BNP Paribas, Cr√©dit Agricole, Soci√©t√© G√©n√©rale, LCL, Banque Postale, etc.</p>
                        </div>
                        <div class="feature">
                            <div class="feature-icon">üìä</div>
                            <h3>Excel structur√©</h3>
                            <p>Relev√© de compte PDF converti en Excel XLS/CSV propre, colonnes organis√©es, pr√™t pour comptabilit√©.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FAQ -->
            <section id="faq" class="seo-section faq-section">
                <div class="container">
                    <h2 class="seo-title">FAQ - Convertir vos relev√©s de compte PDF en Excel</h2>
                    <div class="faq-grid">
                        <div class="faq-item">
                            <h3>Comment convertir vos relev√©s de compte PDF en Excel gratuitement ?</h3>
                            <p>Tr√®s simple ! Glissez votre relev√© de compte PDF, cliquez "Convertir" et t√©l√©chargez votre fichier Excel XLS/CSV. Service fran√ßais 100% gratuit, conforme RGPD.</p>
                        </div>
                        <div class="faq-item">
                            <h3>Quels formats d'Excel puis-je obtenir ?</h3>
                            <p>Votre relev√© de compte PDF est converti en Excel XLS/XLSX et CSV parfaitement structur√©s. Colonnes organis√©es, pr√™ts pour comptabilit√©.</p>
                        </div>
                        <div class="faq-item">
                            <h3>Quelles banques fran√ßaises sont compatibles ?</h3>
                            <p>Convertir vos relev√©s de compte PDF en Excel fonctionne avec toutes banques fran√ßaises : BNP Paribas, Cr√©dit Agricole, Soci√©t√© G√©n√©rale, LCL, Banque Postale, etc.</p>
                        </div>
                        <div class="faq-item">
                            <h3>Mes donn√©es bancaires sont-elles s√©curis√©es ?</h3>
                            <p>Absolument. Vos relev√©s PDF sont trait√©s de mani√®re s√©curis√©e en France, uniquement pour conversion, puis supprim√©s. Conforme RGPD.</p>
                        </div>
                        <div class="faq-item">
                            <h3>Puis-je convertir plusieurs relev√©s en m√™me temps ?</h3>
                            <p>Oui ! Convertir vos relev√©s de compte PDF en Excel supporte les fichiers multiples. Jusqu'√† 10MB par PDF, traitez tous vos comptes simultan√©ment.</p>
                        </div>
                        <div class="faq-item">
                            <h3>Que faire si mon relev√© PDF ne se convertit pas ?</h3>
                            <p>V√©rifiez que votre relev√© de compte PDF est lisible (pas d'image scann√©e floue). Notre service convertit 99% des relev√©s bancaires fran√ßais.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CTA Section -->
            <section class="seo-section cta-section">
                <div class="container">
                    <h2 class="seo-title">Convertissez vos relev√©s de compte PDF en Excel maintenant</h2>
                    <p class="cta-subtitle">Convertissez vos relev√©s de compte PDF en Excel gratuitement en ligne. Service fran√ßais, toutes banques, s√©curis√©.</p>
                    <button class="btn-primary large" onclick="document.getElementById('fileInput').click()" aria-label="Convertissez vos relev√©s de compte PDF en Excel gratuitement">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        </svg>
                        Convertir vos Relev√©s PDF en Excel - Gratuit
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Authentication Modal -->
    <div class="modal-overlay" id="authModal">
        <div class="auth-modal" style="position: relative;">
            <button class="modal-close" onclick="closeAuthModal()">&times;</button>
            
            <!-- Email Step -->
            <div class="auth-step active" id="emailStep">
                <div class="modal-header">
                    <h2 class="modal-title" id="modalTitle">Se connecter</h2>
                    <p class="modal-subtitle">Nous allons vous envoyer un code de v√©rification par email</p>
                </div>
                
                <form onsubmit="submitEmail(event)">
                    <div class="form-group">
                        <label class="form-label" for="emailInput">Adresse email</label>
                        <input 
                            type="email" 
                            id="emailInput" 
                            class="form-input" 
                            placeholder="votre@email.com"
                            required
                        />
                        <div class="form-error" id="emailError"></div>
                    </div>
                    
                    <button type="submit" class="modal-button" id="emailSubmitBtn">
                        Envoyer le code
                    </button>
                </form>
                
                <button class="modal-button secondary" onclick="closeAuthModal()">
                    Annuler
                </button>
            </div>
            
            <!-- OTP Step -->
            <div class="auth-step" id="otpStep">
                <div class="modal-header">
                    <h2 class="modal-title">V√©rification</h2>
                    <p class="modal-subtitle">
                        Entrez le code de v√©rification envoy√© √†<br>
                        <strong id="emailDisplay"></strong>
                    </p>
                </div>
                
                <form onsubmit="submitOTP(event)">
                    <div class="form-group">
                        <label class="form-label" for="otpInput">Code de v√©rification (6 chiffres)</label>
                        <input 
                            type="text" 
                            id="otpInput" 
                            class="form-input otp-input" 
                            placeholder="123456"
                            maxlength="6"
                            pattern="[0-9]{6}"
                            required
                        />
                        <div class="form-error" id="otpError"></div>
                    </div>
                    
                    <button type="submit" class="modal-button" id="otpSubmitBtn">
                        Se connecter
                    </button>
                </form>
                
                <div class="resend-info">
                    Vous n'avez pas re√ßu le code ? 
                    <button class="resend-button" id="resendBtn" onclick="resendOTP()">
                        Renvoyer le code
                    </button>
                    <div id="resendCountdown"></div>
                </div>
                
                <button class="modal-button secondary" onclick="goBackToEmail()">
                    Changer d'email
                </button>
            </div>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        let currentAuthState = 'loading'; // 'loading', 'anonymous', 'authenticated'
        let userInfo = null;

        // Initialize API-based Authentication
        async function initializeAuth() {
            console.log('üöÄ Initialisation de l\'authentification API...');
            
            try {
                // Check balance to determine auth state and create session if needed
                await checkBalance();
                await updateAuthUI();
            } catch (error) {
                console.error('‚ùå Erreur lors de l\'initialisation de l\'authentification:', error);
                currentAuthState = 'anonymous';
                await updateAuthUI();
            }
        }

        // Check balance to determine authentication state
        async function checkBalance() {
            console.log('üîç V√©rification du balance...');
            
            try {
                const response = await fetch('https://api.convertir-releve-compte-pdf-excel.com/api/credits/balance', {
                    method: 'GET',
                    credentials: 'include'
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('‚úÖ Balance re√ßu:', data);
                    
                    currentAuthState = data.mode; // 'anonymous' or 'authenticated'
                    
                    if (data.mode === 'authenticated') {
                        // Store user info if available
                        userInfo = data.userInfo || null;
                    }
                } else {
                    console.error('‚ùå Erreur lors de la v√©rification du balance:', response.status);
                    currentAuthState = 'anonymous';
                }
            } catch (error) {
                console.error('‚ùå Erreur r√©seau lors de la v√©rification du balance:', error);
                currentAuthState = 'anonymous';
            }
        }

        // Update UI based on authentication state  
        async function updateAuthUI() {
            console.log('üîç Mise √† jour de l\'UI d\'authentification...', currentAuthState);
            
            const authLoading = document.getElementById('auth-loading');
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const userGreeting = document.getElementById('userGreeting');
            const loginBtn = authButtons?.querySelector('button:first-child');
            const registerBtn = authButtons?.querySelector('button:last-child');

            // Hide loading state
            authLoading.classList.add('hidden');

            switch (currentAuthState) {
                case 'authenticated':
                    console.log('üë§ Utilisateur authentifi√©');
                        showUserMenu();
                    userGreeting.textContent = userInfo?.name ? `Bonjour ${userInfo.name} !` : 'Bonjour !';
                    break;
                
                case 'anonymous':
                default:
                    console.log('üë§ Utilisateur anonyme');
                        showAuthButtons();
                    if (loginBtn) loginBtn.textContent = 'Se connecter';
                    if (registerBtn) registerBtn.textContent = 'S\'enregistrer';
                    break;
            }
        }

        function showAuthButtons() {
            hideAllAuthStates();
            document.getElementById('auth-buttons').classList.remove('hidden');
        }

        function showUserMenu() {
            hideAllAuthStates();
            document.getElementById('user-menu').classList.remove('hidden');
        }

        function hideAllAuthStates() {
            document.getElementById('auth-loading').classList.add('hidden');
            document.getElementById('auth-buttons').classList.add('hidden');
            document.getElementById('user-menu').classList.add('hidden');
        }

        // Authentication handlers
        async function handleLogin() {
            console.log('üîç handleLogin appel√©');
            showAuthModal(false); // false = login mode
        }

        async function handleRegister() {
            console.log('üîç handleRegister appel√©');
            showAuthModal(true); // true = register mode
        }

        async function handleLogout() {
            console.log('üîç handleLogout appel√©');
            
            try {
                const response = await fetch('https://api.convertir-releve-compte-pdf-excel.com/api/auth/logout', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    console.log('‚úÖ D√©connexion r√©ussie');
                    currentAuthState = 'anonymous';
                    userInfo = null;
                    await updateAuthUI();
                    showMessage('D√©connexion r√©ussie', 'success');
                } else {
                    console.error('‚ùå Erreur lors de la d√©connexion:', response.status);
                    showMessage('Erreur lors de la d√©connexion', 'error');
                }
            } catch (error) {
                console.error('‚ùå Erreur r√©seau lors de la d√©connexion:', error);
                showMessage('Erreur r√©seau lors de la d√©connexion', 'error');
            }
        }

        // Initialize authentication when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üìÑ Page charg√©e, initialisation...');
            initializeAuth();
        });

        // Check balance periodically and on focus
        window.addEventListener('focus', () => {
            console.log('üîç Focus sur la fen√™tre, v√©rification du balance...');
            checkBalance().then(() => updateAuthUI());
        });

        // Modal and OTP Authentication Functions
        let currentEmail = '';
        let resendCountdown = 0;
        let resendTimer = null;

        // Show authentication modal
        function showAuthModal(isRegisterMode = false) {
            const modal = document.getElementById('authModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalSubtitle = modal.querySelector('.modal-subtitle');
            
            // Set title and subtitle based on mode
            modalTitle.textContent = isRegisterMode ? 'S\'enregistrer' : 'Se connecter';
            modalSubtitle.textContent = isRegisterMode 
                ? 'Cr√©ez votre compte en entrant votre email'
                : 'Nous allons vous envoyer un code de v√©rification par email';
            
            // Reset modal state
            showEmailStep();
            clearFormErrors();
            document.getElementById('emailInput').value = '';
            document.getElementById('otpInput').value = '';
            
            // Show modal
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            
            // Focus on email input
            setTimeout(() => {
                document.getElementById('emailInput').focus();
            }, 300);
        }

        // Close authentication modal
        function closeAuthModal() {
            const modal = document.getElementById('authModal');
            modal.classList.remove('show');
            document.body.style.overflow = ''; // Restore scrolling
            
            // Clear any ongoing timers
            if (resendTimer) {
                clearInterval(resendTimer);
                resendTimer = null;
            }
        }

        // Show email step
        function showEmailStep() {
            document.getElementById('emailStep').classList.add('active');
            document.getElementById('otpStep').classList.remove('active');
        }

        // Show OTP step
        function showOTPStep() {
            document.getElementById('emailStep').classList.remove('active');
            document.getElementById('otpStep').classList.add('active');
            document.getElementById('emailDisplay').textContent = currentEmail;
            
            // Focus on OTP input
            setTimeout(() => {
                document.getElementById('otpInput').focus();
            }, 100);
        }

        // Go back to email step
        function goBackToEmail() {
            showEmailStep();
            clearFormErrors();
        }

        // Clear form errors
        function clearFormErrors() {
            document.getElementById('emailError').textContent = '';
            document.getElementById('otpError').textContent = '';
            document.getElementById('emailInput').classList.remove('error');
            document.getElementById('otpInput').classList.remove('error');
        }

        // Show form error
        function showFormError(inputId, errorId, message) {
            document.getElementById(errorId).textContent = message;
            document.getElementById(inputId).classList.add('error');
        }

        // Submit email for OTP
        async function submitEmail(event) {
            event.preventDefault();
            
            const emailInput = document.getElementById('emailInput');
            const email = emailInput.value.trim();
            const submitBtn = document.getElementById('emailSubmitBtn');
            
            // Clear previous errors
            clearFormErrors();
            
            // Validate email
            if (!email || !email.includes('@')) {
                showFormError('emailInput', 'emailError', 'Veuillez entrer une adresse email valide');
                return;
            }
            
            // Show loading state
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('https://api.convertir-releve-compte-pdf-excel.com/api/auth/otp/request', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email: email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    console.log('‚úÖ OTP envoy√© avec succ√®s');
                    currentEmail = email;
                    showOTPStep();
                    startResendCountdown();
                } else {
                    console.error('‚ùå Erreur lors de l\'envoi de l\'OTP:', data);
                    const errorMessage = getErrorMessage(data.error?.code, 'Erreur lors de l\'envoi du code');
                    showFormError('emailInput', 'emailError', errorMessage);
                }
            } catch (error) {
                console.error('‚ùå Erreur r√©seau lors de l\'envoi de l\'OTP:', error);
                showFormError('emailInput', 'emailError', 'Erreur r√©seau. Veuillez r√©essayer.');
            } finally {
                // Reset button state
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        // Submit OTP for verification
        async function submitOTP(event) {
            event.preventDefault();
            
            const otpInput = document.getElementById('otpInput');
            const otp = otpInput.value.trim();
            const submitBtn = document.getElementById('otpSubmitBtn');
            
            // Clear previous errors
            clearFormErrors();
            
            // Validate OTP
            if (!otp || otp.length !== 6 || !/^\d{6}$/.test(otp)) {
                showFormError('otpInput', 'otpError', 'Veuillez entrer un code √† 6 chiffres');
                return;
            }
            
            // Show loading state
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('https://api.convertir-releve-compte-pdf-excel.com/api/auth/otp/verify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include', // Important for cookies
                    body: JSON.stringify({ 
                        email: currentEmail, 
                        otp: otp 
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    console.log('‚úÖ Authentification r√©ussie:', data);
                    
                    // Update auth state
                    currentAuthState = 'authenticated';
                    userInfo = { name: currentEmail.split('@')[0] }; // Simple name from email
                    
                    // Close modal and update UI
                    closeAuthModal();
                    await updateAuthUI();
                    showMessage('Connexion r√©ussie !', 'success');
                    
                    // Always redirect to authenticated page after successful login
                    setTimeout(() => {
                        window.location.href = '/authenticated.html';
                    }, 1500);
                } else {
                    console.error('‚ùå Erreur lors de la v√©rification OTP:', data);
                    const errorMessage = getErrorMessage(data.error?.code, 'Code de v√©rification incorrect');
                    showFormError('otpInput', 'otpError', errorMessage);
                }
            } catch (error) {
                console.error('‚ùå Erreur r√©seau lors de la v√©rification OTP:', error);
                showFormError('otpInput', 'otpError', 'Erreur r√©seau. Veuillez r√©essayer.');
            } finally {
                // Reset button state
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        // Resend OTP
        async function resendOTP() {
            if (resendCountdown > 0) return;
            
            const resendBtn = document.getElementById('resendBtn');
            resendBtn.disabled = true;
            
            try {
                const response = await fetch('https://api.convertir-releve-compte-pdf-excel.com/api/auth/otp/request', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email: currentEmail })
                });
                
                if (response.ok) {
                    console.log('‚úÖ OTP renvoy√© avec succ√®s');
                    startResendCountdown();
                    document.getElementById('otpInput').value = ''; // Clear OTP input
                } else {
                    console.error('‚ùå Erreur lors du renvoi de l\'OTP');
                    showFormError('otpInput', 'otpError', 'Impossible de renvoyer le code. Veuillez r√©essayer plus tard.');
                }
            } catch (error) {
                console.error('‚ùå Erreur r√©seau lors du renvoi de l\'OTP:', error);
                showFormError('otpInput', 'otpError', 'Erreur r√©seau. Impossible de renvoyer le code.');
            }
        }

        // Start resend countdown
        function startResendCountdown() {
            resendCountdown = 60; // 60 seconds
            const resendBtn = document.getElementById('resendBtn');
            const countdownDiv = document.getElementById('resendCountdown');
            
            resendBtn.disabled = true;
            
            resendTimer = setInterval(() => {
                resendCountdown--;
                countdownDiv.textContent = `Vous pourrez renvoyer le code dans ${resendCountdown}s`;
                
                if (resendCountdown <= 0) {
                    clearInterval(resendTimer);
                    resendTimer = null;
                    resendBtn.disabled = false;
                    countdownDiv.textContent = '';
                }
            }, 1000);
        }

        // Get user-friendly error message
        function getErrorMessage(errorCode, defaultMessage) {
            const errorMessages = {
                'INVALID_EMAIL': 'Adresse email invalide',
                'OTP_INVALID': 'Code de v√©rification incorrect',
                'OTP_EXPIRED': 'Code de v√©rification expir√©. Demandez un nouveau code.',
                'OTP_CONSUMED': 'Ce code a d√©j√† √©t√© utilis√©. Demandez un nouveau code.',
                'OTP_RATE_LIMITED': 'Trop de tentatives. Veuillez patienter avant de redemander un code.',
                'DAILY_QUOTA_EXCEEDED': 'Quota quotidien gratuit d√©pass√©',
                'INSUFFICIENT_FUNDS': 'Cr√©dits insuffisants',
                'NOT_FOUND': 'Service non trouv√©',
                'FORBIDDEN': 'Acc√®s refus√©',
                'INTERNAL_ERROR': 'Erreur interne du serveur'
            };
            
            return errorMessages[errorCode] || defaultMessage;
        }

        // Close modal when clicking outside
        document.getElementById('authModal').addEventListener('click', (event) => {
            if (event.target === event.currentTarget) {
                closeAuthModal();
            }
        });

        // Handle escape key to close modal
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                closeAuthModal();
            }
        });

        // Auto-format OTP input (numbers only)
        document.getElementById('otpInput').addEventListener('input', (event) => {
            event.target.value = event.target.value.replace(/\D/g, '');
        });

        // DOM Elements
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        const submitBtn = document.getElementById('submitBtn');
        const message = document.getElementById('message');
        const resultsSection = document.getElementById('resultsSection');
        const resultsInfo = document.getElementById('resultsInfo');
        const tablesContainer = document.getElementById('tablesContainer');

        // Global variable to store API response data
        let apiResponseData = null;

        // Event Listeners
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', handleDragOver);
        dropZone.addEventListener('dragleave', handleDragLeave);
        dropZone.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);

        function handleDragOver(e) {
            e.preventDefault();
            dropZone.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            dropZone.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            addFiles(files);
        }

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            addFiles(files);
        }

        function addFiles(files) {
            const pdfFiles = files.filter(file => file.type === 'application/pdf');
            
            if (pdfFiles.length !== files.length) {
                showMessage('Seuls les fichiers PDF sont accept√©s.', 'error');
                return;
            }

            pdfFiles.forEach(file => {
                if (file.size > 10 * 1024 * 1024) { // 10MB limit
                    showMessage(`Le fichier ${file.name} d√©passe la taille limite de 10MB.`, 'error');
                    return;
                }

                if (!selectedFiles.some(f => f.name === file.name && f.size === file.size)) {
                    selectedFiles.push(file);
                }
            });

            updateFileList();
            updateSubmitButton();
            hideMessage();
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
            updateSubmitButton();
        }

        function updateFileList() {
            fileList.innerHTML = '';
            
            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        </svg>
                        <div>
                            <div class="file-name">${file.name}</div>
                            <div class="file-size">${formatFileSize(file.size)}</div>
                        </div>
                    </div>
                    <button class="remove-file" onclick="removeFile(${index})">Supprimer</button>
                `;
                fileList.appendChild(fileItem);
            });
        }

        function updateSubmitButton() {
            if (selectedFiles.length > 0) {
                submitBtn.classList.add('enabled');
                submitBtn.textContent = `Convertir ${selectedFiles.length} fichier${selectedFiles.length > 1 ? 's' : ''}`;
            } else {
                submitBtn.classList.remove('enabled');
                submitBtn.textContent = 'Convertir les fichiers';
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showMessage(text, type) {
            message.textContent = text;
            message.className = `message ${type}`;
            message.classList.remove('hidden');
        }

        function hideMessage() {
            message.classList.add('hidden');
        }

        async function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => {
                    // Remove the data:application/pdf;base64, prefix
                    const base64 = reader.result.split(',')[1];
                    resolve(base64);
                };
                reader.onerror = error => reject(error);
            });
        }

        async function submitFiles() {
            if (selectedFiles.length === 0) return;

            // Show loading state
            submitBtn.classList.add('loading');
            submitBtn.innerHTML = '<div class="spinner"></div>Conversion en cours...';
            hideMessage();

            try {
                // Convert files to base64
                const filesData = await Promise.all(
                    selectedFiles.map(async (file) => {
                        const base64 = await fileToBase64(file);
                        return {
                            data: base64,
                            filename: file.name,
                            size: file.size
                        };
                    })
                );

                // Send to API
                const response = await fetch('https://api.v1.buyingsignal.io/webhook/bank-to-xlsx', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(filesData)
                });

                if (response.ok) {
                    const responseArray = await response.json();
                    // Extract the first object from the array response
                    const responseData = Array.isArray(responseArray) && responseArray.length > 0 
                        ? responseArray[0] 
                        : responseArray;
                    
                    apiResponseData = responseData;
                    
                    showMessage('Fichiers convertis avec succ√®s!', 'success');
                    displayResults(responseData);
                    
                    // Reset the form
                    selectedFiles = [];
                    updateFileList();
                    updateSubmitButton();
                    fileInput.value = '';
                } else {
                    const errorText = await response.text();
                    throw new Error(`Erreur ${response.status}: ${response.statusText}${errorText ? ' - ' + errorText : ''}`);
                }

            } catch (error) {
                console.error('Error:', error);
                showMessage(`Erreur lors de l'envoi: ${error.message}`, 'error');
            } finally {
                // Reset button state
                submitBtn.classList.remove('loading');
                updateSubmitButton();
            }
        }

        function displayResults(data) {
            // Show results section
            resultsSection.classList.remove('hidden');
            
            // Display global info
            resultsInfo.innerHTML = `
                <h4>Informations sur la conversion</h4>
                <p><strong>Fichiers trait√©s:</strong> ${data.global_stats?.files_processed || data.files?.length || 0}</p>
                <p><strong>Fichiers r√©ussis:</strong> ${data.global_stats?.files_successful || data.files?.length || 0}</p>
                <p><strong>Tables trouv√©es au total:</strong> ${data.global_stats?.total_tables || 0}</p>
                <p><strong>Nombre total de lignes:</strong> ${data.global_stats?.total_rows || 0}</p>
                <p><strong>Taille totale des PDFs:</strong> ${data.global_stats?.total_pdf_size_bytes ? formatFileSize(data.global_stats.total_pdf_size_bytes) : 'Non sp√©cifi√©'}</p>
            `;
            
            // Clear previous tables
            tablesContainer.innerHTML = '';
            
            // Display files and their tables
            if (data.files && data.files.length > 0) {
                data.files.forEach((fileData, fileIndex) => {
                    if (fileData.tables && fileData.tables.length > 0) {
                        createFileSection(fileData, fileIndex + 1);
                    }
                });
            }
            
            // Smooth scroll to results with a slight delay to ensure content is rendered
            setTimeout(() => {
                // Get the position of the results section
                const resultsTop = resultsSection.offsetTop;
                // Scroll with some offset to show a bit of context above
                const scrollOffset = resultsTop - 50;
                
                window.scrollTo({
                    top: scrollOffset,
                    behavior: 'smooth'
                });
                
                // Alternative fallback method
                // resultsSection.scrollIntoView({ 
                //     behavior: 'smooth', 
                //     block: 'start',
                //     inline: 'nearest'
                // });
            }, 300);
        }

        function createFileSection(fileData, fileNumber) {
            // Create file header
            const fileHeader = document.createElement('div');
            fileHeader.className = 'file-section-header';
            fileHeader.innerHTML = `
                <h3>Fichier ${fileNumber}: ${fileData.original_filename || fileData.filename || 'Fichier sans nom'}</h3>
                <div class="file-stats">
                    <span><strong>Tables:</strong> ${fileData.stats?.tables_found || fileData.tables?.length || 0}</span>
                    <span><strong>Lignes:</strong> ${fileData.stats?.total_rows || 0}</span>
                    <span><strong>Taille:</strong> ${fileData.stats?.pdf_size_bytes ? formatFileSize(fileData.stats.pdf_size_bytes) : 'N/A'}</span>
                </div>
            `;
            tablesContainer.appendChild(fileHeader);

            // Create tables for this file
            if (fileData.tables && fileData.tables.length > 0) {
                fileData.tables.forEach((tableData, tableIndex) => {
                    if (tableData && tableData.length > 0) {
                        createTable(tableData, tableIndex + 1, fileData.filename || fileData.original_filename);
                    }
                });
            }
        }

        function createTable(tableData, tableNumber, filename) {
            // Filter out rows that don't have proper data structure
            const validRows = tableData.filter(row => {
                // Check if row has actual data (not just empty strings or summary rows)
                const values = Object.values(row);
                return values.some(value => value && value.trim() && !value.includes('TOTAL PRELEVE'));
            });

            if (validRows.length === 0) return;

            // Get column headers from the first row
            const headers = Object.keys(validRows[0]);
            
            // Generate unique ID for this table
            const tableId = `table_${filename}_${tableNumber}`.replace(/[^a-zA-Z0-9]/g, '_');
            
            const tableWrapper = document.createElement('div');
            tableWrapper.className = 'table-wrapper';
            
            tableWrapper.innerHTML = `
                <div class="table-header">
                    <span class="table-header-text">Table ${tableNumber} - ${validRows.length} transactions</span>
                    <button class="table-download-btn" onclick="downloadTableCSV('${tableId}', '${filename}_table_${tableNumber}')">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"/>
                        </svg>
                        CSV
                    </button>
                </div>
                <table class="data-table" id="${tableId}">
                    <thead>
                        <tr>
                            ${headers.map(header => `<th>${header}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
                        ${validRows.map(row => `
                            <tr>
                                ${headers.map(header => `<td>${row[header] || ''}</td>`).join('')}
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            // Store table data for download
            tableWrapper.tableData = { validRows, headers, filename };
            
            tablesContainer.appendChild(tableWrapper);
        }

        function downloadTableCSV(tableId, suggestedFilename) {
            // Find the table element and its data
            const tableElement = document.getElementById(tableId);
            if (!tableElement) {
                showMessage('Table introuvable', 'error');
                return;
            }

            // Get the table wrapper to access stored data
            const tableWrapper = tableElement.closest('.table-wrapper');
            if (!tableWrapper || !tableWrapper.tableData) {
                showMessage('Donn√©es de table introuvables', 'error');
                return;
            }

            const { validRows, headers, filename } = tableWrapper.tableData;

            // Create CSV content
            let csvContent = '';
            
            // Create CSV header
            csvContent += headers.map(header => `"${header}"`).join(',') + '\n';
            
            // Add data rows
            validRows.forEach(row => {
                const rowData = headers.map(header => {
                    const value = row[header] || '';
                    // Escape quotes and wrap in quotes
                    return `"${value.toString().replace(/"/g, '""')}"`;
                });
                csvContent += rowData.join(',') + '\n';
            });

            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                
                // Use suggested filename with .csv extension
                const finalFilename = `${suggestedFilename}.csv`;
                
                link.setAttribute('download', finalFilename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showMessage(`Table CSV t√©l√©charg√©e: ${finalFilename} (${validRows.length} lignes)`, 'success');
            }
        }
    </script>
</body>
</html>
